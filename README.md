
# dawntone 概要ドキュメント

## 🎵 アプリ概要：**dawntone**

コードで音楽を記述し、即時再生・編集・エクスポートできるWebアプリ。  
`.daw`という独自の音楽記法を用いて、VSCodeのように楽曲をプログラミング的に構築できます。

---

## 🧩 主な特徴（機能概要）

| 機能 | 説明 |
|------|------|
| 🎹 音楽スクリプト記法 `.daw` | 音・コード・テンポ・トラック構成を簡潔な記法で記述可能 |
| 🧠 パース（PEG.js） | `.daw`ファイルをリアルタイムで構文解析し、JSON形式に変換 |
| 🔊 リアルタイム再生（Tone.js） | 記述した内容をその場でWeb Audioで再生可能 |
| 💾 自動保存 | 編集内容をブラウザのローカルストレージに自動保存 |
| 📂 ファイル保存・読み込み | `.dawproj`形式でプロジェクト全体を保存・再読込可能 |
| 🎼 MIDIエクスポート | 書いた曲を`.mid`に変換し、LogicやDAWに引き継ぎ可能 |
| ✏️ Monacoエディタ統合 | VSCode互換の高性能コードエディタで快適な編集体験 |
| 📱 スマホ対応 | Vercel上にデプロイ可能なPWAとして設計、モバイル編集可 |

---

## 🛠 機能一覧（詳述）

### 編集
- `.daw`スクリプトの構文ハイライト
- 自動補完（今後対応）
- undo/redo対応（エディタ由来）

### 構文サポート（言語仕様）
- `@key`, `@tempo`, `@velocity`, `@synth`
- `track <name>:` による複数トラック定義
- 和音 `(1,3,5)` や休符 `x`、スケール相対音 `3b`, `4#`
- マクロ定義 `!i = (...)` と再利用
- ループ `@loop` / `@use`
- 名前空間 `@namespace`

### 再生
- Tone.js による再生エンジン
- テンポ／ベロシティ対応
- 複数トラック同時再生（ポリフォニック）

### ストレージ
- localStorageによる自動保存
- `.dawproj`（JSON）で保存・読み込み

### エクスポート
- `tonejs/midi` によるMIDIファイル生成とDL

---

## 💻 動作環境

| 項目 | 内容 |
|------|------|
| フロントエンド | Next.js (App Router), React |
| エディタ | Monaco Editor |
| パーサー | PEG.js（ブラウザ内/Node.js双方） |
| 音声エンジン | Tone.js（Web Audio API） |
| ストレージ | localStorage / ファイルDL |
| 対応ブラウザ | Chrome / Firefox / Edge / Safari（モバイル含む） |
| デプロイ | Vercel, localhost:3000 でも動作 |
